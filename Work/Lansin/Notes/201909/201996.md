# 20190906

結果問題出在 class 名稱的大小寫 ... 加上階層問題

處理完後 完成了一個算是前後台相關的功能 很類似之前專案

的新增文章跟顯示文章

但架構比較大一點 lab101 等上線

開始可以閒個一兩天

{% embed url="https://dotblogs.com.tw/wasichris/2016/07/28/003317" %}

{% embed url="https://www.devart.com/dbforge/sql/sqlcomplete/editions.html" %}



{% embed url="https://www.one-tab.com/page/agmDgxHpTrWHzisRTylrdw" %}

```text
<UserSettings>
  <ApplicationIdentity version="15.0"/>
  <ToolsOptions>
    <ToolsOptionsCategory name="Environment" RegisteredName="Environment"/>
  </ToolsOptions>
  <Category name="Environment_Group" RegisteredName="Environment_Group">
    <Category name="Environment_FontsAndColors" Category="{1EDA5DD4-927A-43a7-810E-7FD247D0DA1D}" Package="{DA9FB551-C724-11d0-AE1F-00A0C90FFFC3}" RegisteredName="Environment_FontsAndColors" PackageName="Visual Studio Environment Package">
      <PropertyValue name="Version">2</PropertyValue>
      <FontsAndColors Version="2.0">
        <Theme Id="{1DED0138-47CE-435E-84EF-9EC1F439B749}"/>
        <Categories>
          <Category GUID="{FF349800-EA43-46C1-8C98-878E78F46501}" FontName="Envy Code R" FontSize="10" CharSet="1" FontIsDefault="No">
            <Items>
              <Item Name="Breakpoint (Enabled)" Foreground="0x00FFFFFF" Background="0x004D25F9" BoldFont="No"/>
              <Item Name="Current Statement" Foreground="0x00000000" Background="0x000FE2F5" BoldFont="No"/>
            </Items>
          </Category>
          <Category GUID="{58E96763-1D3B-4E05-B6BA-FF7115FD0B7B}" FontName="Envy Code R" FontSize="10" CharSet="1" FontIsDefault="No">
            <Items>
              <Item Name="Indicator Margin" Foreground="0x02000000" Background="0x00333333" BoldFont="No"/>
              <Item Name="Inactive Selected Text" Foreground="0x02000000" Background="0x00565656" BoldFont="No"/>
              <Item Name="Selected Text" Foreground="0x02000000" Background="0x00465455" BoldFont="No"/>
              <Item Name="Plain Text" Foreground="0x00F2F8F8" Background="0x00000000" BoldFont="No"/>
            </Items>
          </Category>
          <Category GUID="{FA937F7B-C0D2-46B8-9F10-A7A92642B384}" FontIsDefault="Yes">
            <Items>
              <Item Name="Artboard Background" Foreground="0x02000000" Background="0x02000000"/>
            </Items>
          </Category>
          <Category GUID="{B36B0228-DBAD-4DB0-B9C7-2AD3E572010F}" FontName="Segoe UI" FontSize="9" CharSet="1" FontIsDefault="No">
            <Items>
              <Item Name="Odd Row Items" Foreground="0x00000000" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Even Row Items" Foreground="0x00000000" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Not Downloaded" Foreground="0x00999999" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Target Only" Foreground="0x00000000" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Source Only" Foreground="0x00000000" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Identical content" Foreground="0x00000000" Background="0x00FFFFFF" BoldFont="No"/>
              <Item Name="Different content" Foreground="0x000014E5" Background="0x00FFFFFF" BoldFont="No"/>
            </Items>
          </Category>
          <Category GUID="{E0187991-B458-4F7E-8CA9-42C9A573B56C}" FontName="Envy Code R" FontSize="10" CharSet="1" FontIsDefault="No">
            <Items>
              <Item Name="XML Attribute Quotes" Foreground="0x005CC2CC" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Attribute Value" Foreground="0x005CC2CC" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML CData Section" Foreground="0x00808080" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Attribute" Foreground="0x00969696" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Name" Foreground="0x001E86FD" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Comment" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Delimiter" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="XML Text" Foreground="0x02000000" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Markup Extension Parameter Value" Foreground="0x002EE2A6" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Markup Extension Parameter Name" Foreground="0x00FFFFFF" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Markup Extension Class" Foreground="0x00EFC045" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Attribute Quotes" Foreground="0x00000000" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Attribute Value" Foreground="0x005CC2CC" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML CData Section" Foreground="0x00808080" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Attribute" Foreground="0x00969696" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Name" Foreground="0x001E86FD" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Comment" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Delimiter" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="XAML Text" Foreground="0x02000000" Background="0x02000000" BoldFont="No"/>
              <Item Name="Number" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="String" Foreground="0x0074DBE6" Background="0x02000000" BoldFont="No"/>
              <Item Name="Comment" Foreground="0x0000CA00" Background="0x02000000" BoldFont="No"/>
              <Item Name="Keyword" Foreground="0x007226F9" Background="0x02000000" BoldFont="No"/>
            </Items>
          </Category>
          <Category GUID="{75A05685-00A8-4DED-BAE5-E7A50BFA929A}" FontName="Envy Code R" FontSize="10" CharSet="1" FontIsDefault="No">
            <Items>
              <Item Name="deltadiff.remove.word" Foreground="0x006666FF" Background="0x0000009D" BoldFont="No"/>
              <Item Name="Selected Text" Foreground="0x02000000" Background="0x00465455" BoldFont="No"/>
              <Item Name="urlformat" Foreground="0x0009F1B5" Background="0x02000000" BoldFont="No"/>
              <Item Name="CurrentLineActiveFormat" Foreground="0x00F2EAEA" Background="0x00000000" BoldFont="No"/>
              <Item Name="Selected Text in High Contrast" Foreground="0x00C0C0C0" Background="0x01000001" BoldFont="No"/>
              <Item Name="outlining.square" Foreground="0x002EE2A6" Background="0x001E1D1B" BoldFont="No"/>
              <Item Name="outlining.verticalrule" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="outlining.collapsehintadornment" Foreground="0x00E8DDD7" Background="0x001E1D1B" BoldFont="No"/>
              <Item Name="Line Number" Foreground="0x008A908F" Background="0x0029312F" BoldFont="No"/>
              <Item Name="Number" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="String" Foreground="0x0074DBE6" Background="0x02000000" BoldFont="No"/>
              <Item Name="Operator" Foreground="0x007226F9" Background="0x02000000" BoldFont="No"/>
              <Item Name="Preprocessor Keyword" Foreground="0x006458FF" Background="0x02000000" BoldFont="No"/>
              <Item Name="Keyword" Foreground="0x007226F9" Background="0x02000000" BoldFont="No"/>
              <Item Name="Excluded Code" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="Comment" Foreground="0x0000CA00" Background="0x02000000" BoldFont="No"/>
              <Item Name="brace matching" Foreground="0x02000000" Background="0x00303030" BoldFont="No"/>
              <Item Name="xml doc comment - text" Foreground="0x00969696" Background="0x02000000" BoldFont="No"/>
              <Item Name="type parameter name" Foreground="0x002EE2A6" Background="0x02000000" BoldFont="No"/>
              <Item Name="struct name" Foreground="0x002EE2A6" Background="0x02000000" BoldFont="No"/>
              <Item Name="module name" Foreground="0x002EE2A6" Background="0x02000000" BoldFont="No"/>
              <Item Name="interface name" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="enum name" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="delegate name" Foreground="0x00EFD966" Background="0x02000000" BoldFont="No"/>
              <Item Name="class name" Foreground="0x00EFD966" Background="0x02000000" BoldFont="No"/>
              <Item Name="string - verbatim" Foreground="0x0074DBE6" Background="0x02000000" BoldFont="No"/>
              <Item Name="RoslynActiveStatementTag" Foreground="0x02000000" Background="0x00000000" BoldFont="No"/>
              <Item Name="HTML Tag Delimiter" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Server-Side Script" Foreground="0x006458FF" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Operator" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Entity" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Element Name" Foreground="0x001E86FD" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Comment" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Attribute Value" Foreground="0x005CC2CC" Background="0x02000000" BoldFont="No"/>
              <Item Name="HTML Attribute" Foreground="0x00969696" Background="0x02000000" BoldFont="No"/>
              <Item Name="RazorCode" Foreground="0x02000000" Background="0x00312223" BoldFont="No"/>
              <Item Name="CSS String Value" Foreground="0x00FFFFFF" Background="0x02000000" BoldFont="No"/>
              <Item Name="CSS Property Value" Foreground="0x00FF81AE" Background="0x02000000" BoldFont="No"/>
              <Item Name="CSS Property Name" Foreground="0x0009F1B5" Background="0x02000000" BoldFont="No"/>
              <Item Name="CSS Selector" Foreground="0x00EFC045" Background="0x02000000" BoldFont="No"/>
              <Item Name="CSS Keyword" Foreground="0x004D25F9" Background="0x02000000" BoldFont="No"/>
              <Item Name="CSS Comment" Foreground="0x0058544D" Background="0x02000000" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Property" Foreground="0x00EFD966" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Parameter" Foreground="0x001F97FD" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.MethodStatic" Foreground="0x00FF80FF" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.MethodExtension" Foreground="0x002EE2A6" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Method" Foreground="0x002EE2A6" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Local" Foreground="0x00F2F8F8" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Enum" Foreground="0x00EFD966" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.FieldConstant" Foreground="0x00EFD966" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Field" Foreground="0x00EFD966" Background="0x01000001" BoldFont="No"/>
              <Item Name="ASD-ESH.Definition.Event" Foreground="0x00EFD966" Background="0x01000001" BoldFont="No"/>
            </Items>
          </Category>
        </Categories>
      </FontsAndColors>
    </Category>
  </Category>
</UserSettings>
```

chris\_frewin\_monokai.vssettings

vb 變數 優化 ? lerk & me

```text
'/////////////////////////////////////////////////////////////////////////////////
' 取主頁 default_jsondata 格式
'
' 建檔人員: 阿淞
' 建檔日期: 2019-04-17
' 修改記錄:

' 關連程式:
' 呼叫來源: default.aspx
'/////////////////////////////////////////////////////////////////////////////////
Imports Microsoft.VisualBasic
Imports System.Data
Imports System.IO
Imports Shop.Library.Security
Imports System.Linq
Imports Shop.mng

Partial Class mng_Report_CooperationPartner2_default_jsondata
    Inherits System.Web.UI.Page


    Public sdate As String = ""
    Public edate As String = ""
    Public dateStr As String = ""

    Public TotalCount As Integer = 0
    Public selSort As String '排序欄位
    Public selOrder As String 'asc/desc
    Public PageSize As Integer  '每一頁需要多少筆資料
    Public CurrentPage As Integer '目前在第幾頁
    Public NeedDateForm As Integer '開始取第幾筆資料
    Public NeedDateTo As Integer   '取到第幾筆資料
    Public toSubMoney As String = ""

    Public STATUS As String = ""
    Public TotalCount2 As String = ""
    Public sampleIssend As String = ""

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load

        sdate = RequestString("sdate", RequestActMode.None, RequestMode.SQLInjection)
        edate = RequestString("edate", RequestActMode.None, RequestMode.SQLInjection)

        '待修改LERK沒用的功能及參數請移除
        sampleIssend = RequestString("sampleIssend", RequestActMode.None, RequestMode.SQLInjection)

        '待修改LERK DataTime 改成Postdate
        If Not String.IsNullOrEmpty(sdate) And Not String.IsNullOrEmpty(edate) Then
            dateStr = "  Lottery.DataTime >= '" & sdate & "' AND Lottery.DataTime <= '" & edate & "' "
        Else
            '取當月訂單資料
            Dim sYear As String = DateTime.Now.Year.ToString
            Dim sMonth As String = DateTime.Now.Month.ToString
            Dim sDay As String = "1"
            Dim eYear As String = DateTime.Now.Year.ToString
            Dim eMonth As String = DateTime.Now.Month.ToString
            Dim eDay As String = DateTime.DaysInMonth(Convert.ToInt16(eYear), Convert.ToInt16(eMonth)) '求出某年某月的最後一天
            dateStr = "  Lottery.DataTime >= '" & sYear & "/" & sMonth & "/" & sDay & "' AND Lottery.DataTime <= '" & eYear & "/" & eMonth & "/" & eDay & "' "
        End If

        Dim _dt1 As DataTable = New DataTable
        Dim _dt2 As DataTable = New DataTable

        Dim FF As New Report()
        Dim SubSubMoney As Integer = 0


        '2016-06-16 LERK 改寫舊排序寫法
        selSort = SQLIJ(Request("Sort")) & " "
        selOrder = SQLIJ(Request("Order"))
        If String.IsNullOrWhiteSpace(selSort) Then selSort = "Lottery.DataTime "  '要留空格避免組sql會變成 postdate
        If String.IsNullOrWhiteSpace(selOrder) Then selOrder = "asc"

        PageSize = If(Request("rows") Is Nothing, "20", RequestString("rows"))
        CurrentPage = If(Request("page") Is Nothing, "1", RequestString("page"))
        '如果目前在第1頁，1頁要顯示20筆資料。則需要顯示的資料就是第0筆至第19筆
        '如果目前在第2頁，1頁要顯示20筆資料。則需要顯示的資料就是第20筆至第39筆
        NeedDateForm = ((CurrentPage - 1) * PageSize)
        NeedDateTo = (CurrentPage * PageSize) - 1


        _dt1 = order1()
        If _dt1.Rows.Count > 0 Then
            TotalCount = _dt1.Rows.Count
        End If
        Dim _fieldDataToDt As New Report()
        _dt1 = _fieldDataToDt.DtCopy(_dt1, NeedDateForm, NeedDateTo) '求出跳頁資料
        With rptdata
            .DataSource = _dt1
            .DataBind()
        End With

    End Sub

    Function order1() As DataTable
        Dim tempdt As DataTable = New DataTable
        Dim sql_all = New System.Text.StringBuilder()

        With (sql_all)
            .Append(" SELECT Lottery.id,[Name],CASE Lottery.Sex WHEN 1 THEN '男' WHEN 0 THEN '女' END as Sex,Convert(varchar(10),Birthday,111) as Birthday,Email,MobilePhone,RTRIM(City.CityName)+RTRIM([State].[StateName])+DeliverAddr as address,InvNO,convert(varchar, PayDate, 111) as PayDate,Convert(varchar(10),DataTime,111) as DataTime,TotalMoney,Market,Goodsname,memo,'' as cno " & vbCrLf)
            .Append(" FROM Lottery  " & vbCrLf)
            .Append(" INNER join City   " & vbCrLf)
            .Append(" ON City.CityNo = Lottery.DeliverCity  " & vbCrLf)
            .Append(" INNER JOIN [State]  " & vbCrLf)
            .Append(" ON [State].[StateNo] = Lottery.DeliverState  " & vbCrLf)
            .Append(" where" & dateStr & vbCrLf)
            .Append(" ORDER BY " & selSort & selOrder)
        End With
        'Response.Write(sql_all)
        'Response.End()
        tempdt = Shop.DB.ExecuteDataTable(sql_all.ToString)

        Return tempdt


    End Function

End Class

```

lerk

```text
'/////////////////////////////////////////////////////////////////////////////////
' 取主頁 default_jsondata 格式
'
' 建檔人員: 阿淞
' 建檔日期: 2019-04-17
' 修改記錄:

' 關連程式:
' 呼叫來源: default.aspx
'/////////////////////////////////////////////////////////////////////////////////
Imports Microsoft.VisualBasic
Imports System.Data
Imports System.IO
Imports Shop.Library.Security
Imports System.Linq
Imports Shop.mng

Partial Class mng_Report_CooperationPartner2_default_jsondata
    Inherits System.Web.UI.Page


    Public sdate As String = ""
    Public edate As String = ""
    Public dateStr As String = ""

    Public TotalCount As Integer = 0
    Public selSort As String '排序欄位
    Public selOrder As String 'asc/desc
    Public PageSize As Integer  '每一頁需要多少筆資料
    Public CurrentPage As Integer '目前在第幾頁
    Public NeedDateForm As Integer '開始取第幾筆資料
    Public NeedDateTo As Integer   '取到第幾筆資料
    Public toSubMoney As String = ""

    Public STATUS As String = ""
    Public TotalCount2 As String = ""
    Public sampleIssend As String = ""

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load

        sdate = RequestString("sdate", RequestActMode.None, RequestMode.SQLInjection)
        edate = RequestString("edate", RequestActMode.None, RequestMode.SQLInjection)
        sampleIssend = RequestString("sampleIssend", RequestActMode.None, RequestMode.SQLInjection)

        If Not String.IsNullOrEmpty(sdate) And Not String.IsNullOrEmpty(edate) Then
            dateStr = " and sr.postdate >= '" & sdate & "' AND sr.postdate <= '" & edate & "' "
            'If Not String.IsNullOrEmpty(sampleIssend) Then
            '    If sampleIssend = 1 Then
            '        dateStr += " and sr.sendno is not null "
            '    ElseIf sampleIssend = 2 Then
            '        dateStr += " and sr.sendno is null "
            '    End If
            'End If
        Else
            '取當月訂單資料
            Dim sYear As String = DateTime.Now.Year.ToString
            Dim sMonth As String = DateTime.Now.Month.ToString
            Dim sDay As String = "1"
            Dim eYear As String = DateTime.Now.Year.ToString
            Dim eMonth As String = DateTime.Now.Month.ToString
            Dim eDay As String = DateTime.DaysInMonth(Convert.ToInt16(eYear), Convert.ToInt16(eMonth)) '求出某年某月的最後一天
            dateStr = " and sr.postdate >= '" & sYear & "/" & sMonth & "/" & sDay & "' AND sr.postdate <= '" & eYear & "/" & eMonth & "/" & eDay & "' "
        End If

        Dim _dt1 As DataTable = New DataTable
        Dim _dt2 As DataTable = New DataTable

        Dim FF As New Report()
        Dim SubSubMoney As Integer = 0


        '2016-06-16 LERK 改寫舊排序寫法
        selSort = SQLIJ(Request("Sort")) & " "
        selOrder = SQLIJ(Request("Order"))
        If String.IsNullOrWhiteSpace(selSort) Then selSort = "sr.postdate "  '要留空格避免組sql會變成 postdate
        If String.IsNullOrWhiteSpace(selOrder) Then selOrder = "asc"

        PageSize = If(Request("rows") Is Nothing, "20", RequestString("rows"))
        CurrentPage = If(Request("page") Is Nothing, "1", RequestString("page"))
        '如果目前在第1頁，1頁要顯示20筆資料。則需要顯示的資料就是第0筆至第19筆
        '如果目前在第2頁，1頁要顯示20筆資料。則需要顯示的資料就是第20筆至第39筆
        NeedDateForm = ((CurrentPage - 1) * PageSize)
        NeedDateTo = (CurrentPage * PageSize) - 1


        _dt1 = order1()
        If _dt1.Rows.Count > 0 Then
            TotalCount = _dt1.Rows.Count
        End If
        Dim _fieldDataToDt As New Report()
        _dt1 = _fieldDataToDt.DtCopy(_dt1, NeedDateForm, NeedDateTo) '求出跳頁資料
        With rptdata
            .DataSource = _dt1
            .DataBind()
        End With

    End Sub

    Function order1() As DataTable
        Dim tempdt As DataTable = New DataTable
        Dim aa As String = """"
        Dim sql_str = New System.Text.StringBuilder()
        With (sql_str)
            .Append(" SELECT Lottery.id,[Name],CASE Lottery.Sex WHEN 1 THEN '男' WHEN 0 THEN '女' END as Sex,Convert(varchar(10),Birthday,111) as Birthday,Email,MobilePhone,RTRIM(City.CityName)+RTRIM([State].[StateName])+DeliverAddr as address,InvNO,convert(varchar, PayDate, 111) as PayDate,Convert(varchar(10),DataTime,111) as DataTime,TotalMoney,Market,Goodsname,memo,'' as cno " & vbCrLf)
            .Append(" FROM Lottery  " & vbCrLf)
            .Append(" INNER join City   " & vbCrLf)
            .Append(" ON City.CityNo = Lottery.DeliverCity  " & vbCrLf)
            .Append(" INNER JOIN [State]  " & vbCrLf)
            .Append(" ON [State].[StateNo] = Lottery.DeliverState  " & vbCrLf)
            .Append(" where PayDate >= DATEADD(day,DATEDIFF(day,'','{0}'),'')  " & vbCrLf)
            .Append(" AND PayDate <= DATEADD(day,DATEDIFF(day,'','{1}'),'')  " & vbCrLf)
        End With

        Dim sql_all = New System.Text.StringBuilder()

        If sdate = "" Or edate = "" Then

            With (sql_all)
                .Append(" SELECT Lottery.id,[Name],CASE Lottery.Sex WHEN 1 THEN '男' WHEN 0 THEN '女' END as Sex,Convert(varchar(10),Birthday,111) as Birthday,Email,MobilePhone,RTRIM(City.CityName)+RTRIM([State].[StateName])+DeliverAddr as address,InvNO,convert(varchar, PayDate, 111) as PayDate,Convert(varchar(10),DataTime,111) as DataTime,TotalMoney,Market,Goodsname,memo,'' as cno " & vbCrLf)
                .Append(" FROM Lottery  " & vbCrLf)
                .Append(" INNER join City   " & vbCrLf)
                .Append(" ON City.CityNo = Lottery.DeliverCity  " & vbCrLf)
                .Append(" INNER JOIN [State]  " & vbCrLf)
                .Append(" ON [State].[StateNo] = Lottery.DeliverState  " & vbCrLf)
            End With

            tempdt = Shop.DB.ExecuteDataTable(sql_all.ToString)

            Return tempdt

        Else

            Dim Sql As String
            Sql = sql_str.ToString()
            Sql = String.Format(Sql, sdate, edate)

            tempdt = Shop.DB.ExecuteDataTable(Sql)

            Return tempdt

        End If

    End Function

End Class

```

me

{% embed url="https://zh.wikipedia.org/wiki/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F\_\(%E8%AE%A1%E7%AE%97%E6%9C%BA\)" %}





